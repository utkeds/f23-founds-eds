---
title: "Week 9 Slides"
subtitle: "Group By and Summarize"
author: "**Isabella Vel√°squez and Maryrose Weatherton**"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
---

```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)

style_duo_accent(
    primary_color = "#FF8200",
    secondary_color = "#58595B",
    title_slide_text_color = "#222943",
    title_slide_background_color = "#ededed",
    title_slide_background_image = "https://brand.utk.edu/wp-content/uploads/2019/02/University-HorizRightLogo-RGB.png",
    title_slide_background_position = "bottom",
    title_slide_background_size = "30%"
)
```


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

```{r, echo=FALSE}
# then load all the relevant packages
pacman::p_load(pacman, knitr, tidyverse, readxl)
```

```{r xaringanExtra-clipboard, echo=FALSE}
# these allow any code snippets to be copied to the clipboard so they 
# can be pasted easily
htmltools::tagList(
    xaringanExtra::use_clipboard(button_text = "<i class=\"fa fa-clipboard\"></i>",
                                 success_text = "<i class=\"fa fa-check\" style=\"color: #90BE6D\"></i>", ),
    rmarkdown::html_dependency_font_awesome()
)
```

```{r xaringan-panelset, echo=FALSE}
xaringanExtra::use_panelset()
```

# Purpose and Agenda

What do you need to be able to work with a range of datasets? This week focuses on core data wrangling skills; it is the first of four weeks that equip you with a set of skills focused on the dplyr and tidyr packages that are part of the tidyverse. The context is accessing and preparing data on colleges in advance of building a better rating system.

## What we'll do in this presentation

- Reading Recap
- Discussion
- Key Concept: Group by and summarize
- Code-along and data
- What's next: Assignment(s) and Readings

---

# Reading Recap

Substantive reading(s):

> Morse, R., and & Brooks, E. (2023). How U.S. News Calculated the 2024 Best Colleges Rankings. https://www.usnews.com/education/best-colleges/articles/how-us-news-calculated-the-rankings

> Wolfe, R. (2023). A different kind of college ranking. *Washington Monthly.* https://washingtonmonthly.com/2023/08/27/a-different-kind-of-college-ranking-2/

> Blinder, A. (2023). With a New Formula, U.S. News  Rankings Boost Some State Universities. *New York Times*. https://www.nytimes.com/2023/09/18/us/us-news-college-ranking.html

Technical reading(s):

> Esposito, E., & Stark, D. (2019). What's Observed in a Rating? Rankings as Orientation in the Face of Uncertainty. *Theory, Culture & Society, 36*(4), 3-26.

---

# Discussion

.panelset[

.panel[.panel-name[Background]

- One way we can think about _large and complex_ data sets is whether the data is aggregated---or not
- In education data, it is highly common to aggregate raw data (e.g., individual student assessments) at multiple levels:

- Multiple assessments at the **student level**
- Multiple students at the **teacher level**
- Multiple teachers at the **subject level** and **school level**
- Multiple schools at the **district level**
- Multiple districts at the **state level**

]

.panel[.panel-name[Discussion Questions]

- What counts as raw and aggregated data differs for each field---and even for each research question!
- For your research-related area of interest, what are one or more levels at which raw data is aggregated?
- For which purposes might **raw data** me more useful? For which purposes might aggregate data be useful?

]

]

---

# Key Concept: Group by and summarize

.panelset[

.panel[.panel-name[dplyr "verbs"]

- There are several functions loaded in the dplyr package (which itself is loaded in the tidyverse package) that are useful in practically all analyses
- These are all "verbs": words used to describe an action, state, or occurrence ([OxfordLanguage](https://languages.oup.com/google-dictionary-en/))
- The core dplyr "verbs" are `select()`, `rename()`, `filter()`, `arrange()`, and `mutate()`
]

.panel[.panel-name[select]

- `select()` is used to choose particular columns from a data frame (or tibble)
- It works by specifying the variables you want to keep or remove

```{r, echo = TRUE}
selected_data <- dat %>%
    select(Name, Age)

selected_data
```

- *Important note and point of emphasis*: if we don't assign the output a new name (`selected_data <-`), the results of our use of a dplyr "verb" won't be saved

]

.panel[.panel-name[rename]

- `rename()` changes the names of variables

```{r, echo = TRUE}
selected_renamed_data <- 
    selected_data %>%
    rename(name = Name, age = Age)

selected_renamed_data
```

- *Note*: You can _select_ and _rename_ in a single step using `select()`:

```{r, echo = TRUE}
selected_and_renamed <- 
    dat %>%
    select(name = Name, age = Age) # selects Name and Age and renames them at the same time
```

Because `select()` can be used to rename, `rename()` is rarely used in practice.

Learn more about `select()` and `rename()` [here](https://dplyr.tidyverse.org/reference/select.html), including handy "select helpers"

]

.panel[.panel-name[filter]

- `filter()` keeps or removes the rows of your data based on _logical conditions_ that you specify

```{r, echo = TRUE}
filtered_data <- dat %>%
    filter(Age >= 25)

filtered_data
```

]

.panel[.panel-name[filter]

```{r, echo = TRUE}
filtered_data <- dat %>% 
    filter(State == "TN")

filtered_data
```

Learn more about `filter()` [here](https://dplyr.tidyverse.org/reference/filter.html)

]
]

---

# Key Concept: dplyr "verbs"

.panelset[

.panel[.panel-name[arrange]

- `arrange()` sorts the rows of your data frame based on numeric or alpha-numeric values

```{r, echo = TRUE}
arranged_data <- dat %>% 
    arrange(Name)

arranged_data
```

]

.panel[.panel-name[arrange]

You can reverse the order with `desc()`:

```{r, echo = TRUE}
arranged_data <- dat %>% 
    arrange(desc(Name))

arranged_data
```

Learn more about `arrange()` [here](https://dplyr.tidyverse.org/reference/arrange.html)

]

.panel[.panel-name[mutate]

- `mutate()` creates new variables

```{r, echo = TRUE}
mutated_data <- dat %>%
    mutate(age_next_year = Age + 1)

mutated_data
```

Learn more about `mutate()` [here](https://dplyr.tidyverse.org/reference/mutate.html)

]

]

---

# Code-along

.panelset[

.panel[.panel-name[The basics]

```{r, eval = FALSE, echo = TRUE}
library(educationdata)
library(tidyverse)

```

]

.panel[.panel-name[Different groups]

```{r, eval = FALSE, echo = TRUE}
library(educationdata)
library(tidyverse)

```

]

.panel[.panel-name[Different variables]

```{r, eval = FALSE, echo = TRUE}
library(educationdata)
library(tidyverse)

```

]

.panel[.panel-name[Different summary statistics]

```{r, eval = FALSE, echo = TRUE}
library(educationdata)
library(tidyverse)

```

]

]

---

# What's next?

.panelset[

.panel[.panel-name[Weekly Assignment]

- In the weekly assignment, you will group and summarize school-level data on enrollments, practicing aggregating in three ways:

1. at different levels (groups)
2. for different variables
3. with different summary statistics

]


.panel[.panel-name[Data]

- We'll be using an already-saved version of data we accessed via the educationdata package on school-level enrollments
- The data will be fairly large and complex --- thus suggesting the importance of grouping and summarizing as exploratory data analysis steps

]


.panel[.panel-name[Final Project Planning]

- There is an additional assignment this week: Final Project Planning
- In this assignment, you will read a bit about the final project, and share some _initial, preliminary ideas_ (not final plans!) to receive early feedback (and to get your gears turning regarding what you will do)

]


.panel[.panel-name[Substantive Reading(s)]

- Substantive reading(s) for the week ahead:

> Fischer, C., Pardos, Z. A., Baker, R. S., Williams, J. J., Smyth, P., Yu, R., ... & Warschauer, M. (2020). Mining big data in education: Affordances and challenges. *Review of Research in Education, 44*(1), 130-160.

*In this reading, focus on the complexity of data used in education (or your field) and how and why data mining can involve data at different levels or groups**

]

.panel[.panel-name[Technical Reading(s)]

- Technical reading(s) for the week ahead:

> Summarizing Data by Groups: https://r-graphics.org/recipe-dataprep-summarize

> Data Transformation: https://r4ds.hadley.nz/data-transform

For the second reading, please review section 4.5 (from this reading that we already completed)

]

]
