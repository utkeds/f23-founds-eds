---
title: "Week 6 Slides"
subtitle: "How do I access and describe data? Using an R package and an API"
author: "**Isabella Velásquez and Maryrose Weatherton**"
date: '`r format(Sys.time(), "%B %d, %Y")`'
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
---

```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)

style_duo_accent(primary_color = "#FF8200",
                 secondary_color = "#58595B",
                 title_slide_text_color = "#222943",
                 title_slide_background_color = "#ededed",
                 title_slide_background_image = "https://brand.utk.edu/wp-content/uploads/2019/02/University-HorizRightLogo-RGB.png",
                 title_slide_background_position = "bottom",
                 title_slide_background_size = "30%")
```


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

```{r, echo=FALSE}
# then load all the relevant packages
pacman::p_load(pacman, knitr, tidyverse, readxl)
```

```{r xaringanExtra-clipboard, echo=FALSE}
# these allow any code snippets to be copied to the clipboard so they 
# can be pasted easily
htmltools::tagList(
    xaringanExtra::use_clipboard(
        button_text = "<i class=\"fa fa-clipboard\"></i>",
        success_text = "<i class=\"fa fa-check\" style=\"color: #90BE6D\"></i>",
    ),
    rmarkdown::html_dependency_font_awesome()
)
```

```{r xaringan-panelset, echo=FALSE}
xaringanExtra::use_panelset()
```


# Purpose and Agenda

Data scientists often talk about "digital data" and "log-trace" data. How do we access such data? This week, we explore ways to do that through Application Programming Interfaces, or **APIs**. We'll use the educationdata package to access the Education Data Portal API created by the Urban Institute.

## What we'll do in this presentation

- Discussion
- Reading Recap
- Key Concept: Log-trace data and Application Programming Interfaces (APIs)
- Key Concept: The educationdata package
- Code-along and data
- What's next: Assignment(s) and Readings

---

# Discussion

.panelset[

.panel[.panel-name[Background]

- A variety of services on the Internet allow people -- especially _developers_, but also _researchers_ -- to access data from those services
- These services are many and include social media (Instagram, Facebook, Pinterest, etc.), work-related (e.g., Canvas), governmental (NOAA for weather data, U.S. census data), and personal (Garmin, Nest thermostats)

]

.panel[.panel-name[Discussion Question]

- What is an Internet-based service or organization that provides data that _could_ be of interest to you, either for research or just curiosity? 
- Think broadly and consider doing a bit of research, searching for a service of interest plus the term "API".

]

]

---

# Reading Recap

Substantive reading(s):

> Reich, J. (2022). Learning analytics and learning at scale. Lang, C., Siemens, G. Wise, AF, Gašević, D., Merceron, A.,(eds.) Handbook of Learning Analytics, 2nd ed. Vancouver, Canada: SOLAR.

> White, R. S. (2023). Ceilings Made of Glass and Leaving En Masse? Examining Superintendent Gender Gaps and Turnover Over Time Across the United States. Educational Researcher, 0013189X231163139.

Technical reading(s):

> Introducing educationdata, https://urbaninstitute.github.io/education-data-package-r/articles/introducing-educationdata.html (also, check out other pages on this website)

---

# Key Concept: Log data and APIs

.panelset[

.panel[.panel-name[Log-trace data]

- Different researchers use a variety of terms to refer to *data generated by peoples' interactions with digital services*:
- "Log file data" or "log data" (see [Wise et al., 2012](https://www.sciencedirect.com/science/article/pii/S1096751611000911) and [Rutherford et al., 2022)](https://www.tandfonline.com/doi/pdf/10.1080/15391523.2021.1920520): interactions with learning management systems and educational games
- "Trace data" (see [Winne et al., 2017](https://escholarship.mcgill.ca/concern/articles/v692tb17v)): interactions with a tool intended to support studying
- "Digital traces" (see [Greenhalgh & Koehler, 2017](https://link.springer.com/article/10.1007/s11528-016-0142-4)): tweets
- We use the term **log-trace data** as the referent for this kind of data

]

.panel[.panel-name[How to access]

- Researchers can access log-trace in a variety of ways, including through collaborations with individuals working at educational technology organizations and being the developer of the tool that is generating data
- For larger companies or sources of data that are of wider interest, APIs are more common
- **API**: A set of rules, protocols, and tools that allows software applications (and *programming languages*, like R!) to communicate with each other

]

.panel[.panel-name[Web-based APIs]

- We will focus on a particular type of API, what are referred to as **web-based APIs**, though there are others, including APIs to access databases, messages and emails, and user authentication
- Web-based APIs use the ways we normally interact on the Internet, but with _rules_, _protocols_, and _tools_ that make it easier to use software and programming languages to access data

]

.panel[.panel-name[Example]

- Many web-based APIs that use the ways we normally interact on the Internet are relatively straightforward!
- Here is an example from the Education Data Portal: `https://educationdata.urban.org/api/v1/schools/ccd/enrollment/2013/grade-3/?charter=1&fips=47`
- The URL specifies our request: we want to 1) **access the API**, specifically **version 1**, 2) **request data on schools**, specifically **from the Common Core of Data** data source, 3) even more specifically, we want **enrollment data** for **2013**, 4) for students in **third grade** in **charter schools** in a particular state, **Tennessee**
- See other examples [here](https://educationdata.urban.org/documentation/schools.html)
- Can you _manually_ (by typing out the URL) create another request? **Now, try to access a different data source from a different state.**

]

.panel[.panel-name[Next]

- The issues with what we've just done are several
- *First*, specifying the requests manually (by typing out th eURL) is a bit difficult
- *Second*, the data is returned in JSON format, which we can't directly use in R
- *Third*, what if we want to make several - or very many - requests in series? It is hard to do this through the browser
- The educationdata R package addresses each of these issues with accessing data from the Education Data Portal API

]


]

???

it may be worth checking out those other examples

---

# Key Concept: educationdata

.panelset[

.panel[.panel-name[EDP]

- The [educationdata R package](https://urbaninstitute.github.io/education-data-package-r/index.html) facilitates access to the [Education Data Portal's (EDP's) API](https://educationdata.urban.org/documentation/index.html)
- The EDP provides ready access to a range of education-related data sources; here's a description of the EDP:

> Every year, the federal government releases large amounts of data on U.S. schools, school districts, and colleges. But this information is scattered across multiple datasets that are often difficult to access, and changes in data structure complicate efforts to measure change over time.

> To make these data more accessible, our website is organized by the institutions to which the information pertains: schools, school districts, and colleges. We’ve harmonized variables and documentation across datasets and time to make it easier to look at trends over time and combine data from different sources.

]

.panel[.panel-name[The educationdata R package]

- The [educationdata R package](https://urbaninstitute.github.io/education-data-package-r/index.html) facilitates access to the [Education Data Portal's API](https://educationdata.urban.org/documentation/index.html)
- Example code that replicates what we earlier accessed via URL:

```{r, eval = FALSE, echo = TRUE}
# install.packages("educationdata") # be sure to run this, first

df <- get_education_data(level = 'schools', 
                         source = 'ccd', 
                         topic = 'enrollment', 
                         subtopic = list('race', 'sex'),
                         filters = list(year = 2013,
                                        grade = 3),
                         csv = TRUE) # this makes accessing large data sets faster
```

]

.panel[.panel-name[Advantages]

- The code on the last slide addresses three issues with the URL-based method:
- We can specify the parameters as arguments for the function --- rather than as different parts of a URL
- We receive a data frame as output --- rather than JSON
- We can change the function call to access different data

]

.panel[.panel-name[Documentation]

Two sources of documentation are key for this week and the following weeks

1. The [R package documentation](https://urbaninstitute.github.io/education-data-package-r/articles/introducing-educationdata.html)
2. The [EDP API documentation](https://educationdata.urban.org/documentation/index.html)

**Review these both, seeing how you can access various data sources from the API, noting that the EDP API documentation provides example R code to access any variable in any of the available data sets**

]
]

---

# Code-along

.panelset[

.panel[.panel-name[Start small]

Let's look at 12th-grade enrollment in U.S. schools for 2021

```{r, eval = FALSE, echo = TRUE}
df <- get_education_data(level = "schools",
                         source = "ccd",
                         topic = "enrollment",
                         filters = list(year = 2021, grade = 12))

df <- df %>% as_tibble() # to make inspecting the df easier

df %>% 
    count(ncessch) # how many schools are there in the data?
```

]

.panel[.panel-name[Expanding]

Let's look at _directory_ data to find out how many schools there are in the U.S.

```{r, eval = FALSE, echo = TRUE}
df_2 <- get_education_data(level = "schools",
                           source = "ccd",
                           topic = "directory",
                           filters = list(year = 2021))

df_2 <- df_2 %>% as_tibble() # to make inspecting the df easier

df_2 %>% count(ncessch) # how many schools in the U.S.
df_2 %>% count(state_location) # number of schools by state
```

]

.panel[.panel-name[District data]

Let's do the same for school districts---groups of schools that serve an important role in the U.S. educational system

```{r, eval = FALSE, echo = TRUE}
df_3 <- get_education_data(level = "school-districts",
    source = "ccd",
    topic = "directory",
    filters = list(year = 2021))

df_3 <- as_tibble(df_3)

df_3 %>% count(ncessch) # how many schools in the U.S.
df_3 %>% count(state_location) # number of schools by state
```

]

]

---

# What's next?

.panelset[

.panel[.panel-name[Assignment]

- Whereas in the code-along we focused on school and school district data, we'll be using college-level data for the weekly assignment
- Your task this week is to access data from a few variables, preparing for the following two weeks in which _you will construct a college rating like those created by the U.S. News and World Report_ (but, don't worry about this yet - we'll introduce that task in detail next week)
- One note: **Accessing data from APIs can be tricky!** You often need to run queries multiple times to get them to work; and, you often need to carefully consult the codebook to understand the data that is returned. Stick with it!
- Another note: **Please review the technical reading this week for tips on using the `filter()` function!s**

]

.panel[.panel-name[Data]

- We'll be using data from the educationdata package, specifically college-related data
- This webpage will be very helpful for this: https://educationdata.urban.org/documentation/colleges.html
    - Specifically, review the variables that are available and click over to the "R" tab to get code that you can copy-paste and run

]

.panel[.panel-name[Substantive Reading(s)]

- Substantive reading(s) for the week ahead:

> Rutherford, T., Duck, K., Rosenberg, J. M., & Patt, R. (2022). Leveraging mathematics software data to understand student learning and motivation during the COVID-19 pandemic. Journal of Research on Technology in Education, 54(sup1), S94-S131.

> Rosenberg, J. M., Borchers, C., Burchfield, M. A., Anderson, D., Stegenga, S. M., & Fischer, C. (2022). Posts about students on Facebook: a data ethics perspective. *Educational Researcher, 51*(8), 547-550.

Linked in Canvas.

]

.panel[.panel-name[Technical Reading(s)]

- Technical reading(s) for the week ahead:

> R for Data Science, Data Transformation: https://r4ds.hadley.nz/data-transform

Also linked in Canvas.

]

]